<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/jhnns/rewire">rewire (v2.5.2)</a>
</h1>
<h4>Easy dependency injection for node.js unit testing</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.rewire">module rewire</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.rewire">
            function <span class="apidocSignatureSpan"></span>rewire
            <span class="apidocSignatureSpan">(filename)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">rewire.</span>moduleA</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">rewire.</span>moduleB</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">rewire.</span>moduleEnv</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">rewire.</span>strictModule</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.rewire.moduleA">module rewire.moduleA</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleA.checkSomeGlobals">
            function <span class="apidocSignatureSpan">rewire.moduleA.</span>checkSomeGlobals
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleA.getBuffer">
            function <span class="apidocSignatureSpan">rewire.moduleA.</span>getBuffer
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleA.getConsole">
            function <span class="apidocSignatureSpan">rewire.moduleA.</span>getConsole
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleA.getDocument">
            function <span class="apidocSignatureSpan">rewire.moduleA.</span>getDocument
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleA.getFilename">
            function <span class="apidocSignatureSpan">rewire.moduleA.</span>getFilename
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleA.getMyNumber">
            function <span class="apidocSignatureSpan">rewire.moduleA.</span>getMyNumber
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleA.getMyObj">
            function <span class="apidocSignatureSpan">rewire.moduleA.</span>getMyObj
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleA.readFileSync">
            function <span class="apidocSignatureSpan">rewire.moduleA.</span>readFileSync
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleA.setMyNumber">
            function <span class="apidocSignatureSpan">rewire.moduleA.</span>setMyNumber
            <span class="apidocSignatureSpan">(newNumber)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleA.setMyObj">
            function <span class="apidocSignatureSpan">rewire.moduleA.</span>setMyObj
            <span class="apidocSignatureSpan">(newObj)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">rewire.moduleA.</span>someOtherModule</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.rewire.moduleB">module rewire.moduleB</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleB.checkSomeGlobals">
            function <span class="apidocSignatureSpan">rewire.moduleB.</span>checkSomeGlobals
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleB.getBuffer">
            function <span class="apidocSignatureSpan">rewire.moduleB.</span>getBuffer
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleB.getConsole">
            function <span class="apidocSignatureSpan">rewire.moduleB.</span>getConsole
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleB.getDocument">
            function <span class="apidocSignatureSpan">rewire.moduleB.</span>getDocument
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleB.getFilename">
            function <span class="apidocSignatureSpan">rewire.moduleB.</span>getFilename
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleB.getMyNumber">
            function <span class="apidocSignatureSpan">rewire.moduleB.</span>getMyNumber
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleB.getMyObj">
            function <span class="apidocSignatureSpan">rewire.moduleB.</span>getMyObj
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleB.readFileSync">
            function <span class="apidocSignatureSpan">rewire.moduleB.</span>readFileSync
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleB.setMyNumber">
            function <span class="apidocSignatureSpan">rewire.moduleB.</span>setMyNumber
            <span class="apidocSignatureSpan">(newNumber)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleB.setMyObj">
            function <span class="apidocSignatureSpan">rewire.moduleB.</span>setMyObj
            <span class="apidocSignatureSpan">(newObj)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">rewire.moduleB.</span>someOtherModule</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.rewire.moduleEnv">module rewire.moduleEnv</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleEnv.inject">
            function <span class="apidocSignatureSpan">rewire.moduleEnv.</span>inject
            <span class="apidocSignatureSpan">(prelude, appendix)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.moduleEnv.load">
            function <span class="apidocSignatureSpan">rewire.moduleEnv.</span>load
            <span class="apidocSignatureSpan">(targetModule)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.rewire.strictModule">module rewire.strictModule</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rewire.strictModule.doSomethingUnstrict">
            function <span class="apidocSignatureSpan">rewire.strictModule.</span>doSomethingUnstrict
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.rewire" id="apidoc.module.rewire">module rewire</a></h1>


    <h2>
        <a href="#apidoc.element.rewire.rewire" id="apidoc.element.rewire.rewire">
        function <span class="apidocSignatureSpan"></span>rewire
        <span class="apidocSignatureSpan">(filename)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function rewire(filename) {
    return rewireModule(module.parent, filename);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>










</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.rewire.moduleA" id="apidoc.module.rewire.moduleA">module rewire.moduleA</a></h1>


    <h2>
        <a href="#apidoc.element.rewire.moduleA.checkSomeGlobals" id="apidoc.element.rewire.moduleA.checkSomeGlobals">
        function <span class="apidocSignatureSpan">rewire.moduleA.</span>checkSomeGlobals
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function checkSomeGlobals() {
    var isLowerIE,
        typeOfGlobalFunc;

    if (typeof navigator !== "undefined") {
        isLowerIE = /MSIE [6-8]\.[0-9]/g.test(navigator.userAgent);
    }
    if (isLowerIE) {
        typeOfGlobalFunc = "object";
    } else {
        typeOfGlobalFunc = "function";
    }

    if (typeof global !== "object") {
        throw new ReferenceError("global is not an object");
    }
    if (typeof console !== "object") {
        throw new ReferenceError("console is not an object");
    }
    if (typeof require !== "function") {
        throw new ReferenceError("require is not a function");
    }
    if (typeof module !== "object") {
        throw new ReferenceError("module is not an object");
    }
    if (typeof exports !== "object") {
        throw new ReferenceError("exports is not an object");
    }
    if (module.exports !== exports) {
        throw new Error("module.exports === exports returns false");
    }
    if (typeof __dirname !== "string") {
        throw new ReferenceError("__dirname is not a string");
    }
    if (typeof __filename !== "string") {
        throw new ReferenceError("__filename is not a string");
    }
    if (typeof setTimeout !== typeOfGlobalFunc) {
        throw new ReferenceError("setTimeout is not a function");
    }
    if (typeof clearTimeout !== typeOfGlobalFunc) {
        throw new ReferenceError("clearTimeout is not a function");
    }
    if (typeof setInterval !== typeOfGlobalFunc) {
        throw new ReferenceError("setInterval is not a function");
    }
    if (typeof clearInterval !== typeOfGlobalFunc) {
        throw new ReferenceError("clearInterval is not a function");
    }
    if (typeof Error !== "function") {
        throw new ReferenceError("Error is not a function");
    }
    if (typeof parseFloat !== "function") {
        throw new ReferenceError("parseFloat is not a function");
    }
    if (typeof parseInt !== "function") {
        throw new ReferenceError("parseInt is not a function");
    }
    if (typeof window === "undefined") {
        if (typeof process !== "object") {
            throw new ReferenceError("process is not an object");
        }
        if (typeof Buffer !== "function") {
            throw new ReferenceError("Buffer is not a function");
        }
    } else {
        if (typeof encodeURIComponent !== "function") {
            throw new ReferenceError("encodeURIComponent is not a function");
        }
        if (typeof decodeURIComponent !== "function") {
            throw new ReferenceError("decodeURIComponent is not a function");
        }
        if (typeof document !== "object") {
            throw new ReferenceError("document is not an object");
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    expect(require("./someOtherModule.js").__set__).to.be(undefined);
    expect(require("./someOtherModule.js").__get__).to.be(undefined);
    expect(require("./someOtherModule.js").__with__).to.be(undefined);
});

it("should not override/influence global objects by default", function () {
    // This should throw no exception
    rewire("./moduleA.js").<span class="apidocCodeKeywordSpan">checkSomeGlobals</span>();
    rewire("./moduleB.js").checkSomeGlobals();
});

// This is just an integration test for the __set__ method
// You can find a full test for __set__ under /test/__set__.test.js
it("should provide a working __set__ method", function () {
    var rewiredModuleA = rewire("./moduleA.js"),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleA.getBuffer" id="apidoc.element.rewire.moduleA.getBuffer">
        function <span class="apidocSignatureSpan">rewire.moduleA.</span>getBuffer
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getBuffer() {
    return Buffer;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
expect(rewiredModuleB.getConsole()).not.to.be(consoleMock);
expect(console).not.to.be(consoleMock);
expect(rewiredModuleA.getFilename()).to.be(newFilename);
expect(rewiredModuleB.getFilename()).not.to.be(newFilename);
expect(console).not.to.be(newFilename);
if (typeof window === "undefined") {
    rewiredModuleA.__set__("Buffer", bufferMock);
    expect(rewiredModuleA.<span class="apidocCodeKeywordSpan">getBuffer</span>()).to.be(bufferMock);
    expect(rewiredModuleB.getBuffer()).not.to.be(bufferMock);
    expect(Buffer).not.to.be(bufferMock);
} else {
    rewiredModuleA.__set__("document", documentMock);
    expect(rewiredModuleA.getDocument()).to.be(documentMock);
    expect(rewiredModuleB.getDocument() === documentMock).to.be(false);
    expect(document === documentMock).to.be(false);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleA.getConsole" id="apidoc.element.rewire.moduleA.getConsole">
        function <span class="apidocSignatureSpan">rewire.moduleA.</span>getConsole
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getConsole() {
    return console;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    documentMock = {},
    newFilename = "myFile.js";

rewiredModuleA.__set__({
    console: consoleMock,
    __filename: newFilename
});
expect(rewiredModuleA.<span class="apidocCodeKeywordSpan">getConsole</span>()).to.be(consoleMock);
expect(rewiredModuleB.getConsole()).not.to.be(consoleMock);
expect(console).not.to.be(consoleMock);
expect(rewiredModuleA.getFilename()).to.be(newFilename);
expect(rewiredModuleB.getFilename()).not.to.be(newFilename);
expect(console).not.to.be(newFilename);
if (typeof window === "undefined") {
    rewiredModuleA.__set__("Buffer", bufferMock);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleA.getDocument" id="apidoc.element.rewire.moduleA.getDocument">
        function <span class="apidocSignatureSpan">rewire.moduleA.</span>getDocument
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getDocument() {
    return document;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (typeof window === "undefined") {
        rewiredModuleA.__set__("Buffer", bufferMock);
        expect(rewiredModuleA.getBuffer()).to.be(bufferMock);
        expect(rewiredModuleB.getBuffer()).not.to.be(bufferMock);
        expect(Buffer).not.to.be(bufferMock);
    } else {
        rewiredModuleA.__set__("document", documentMock);
        expect(rewiredModuleA.<span class="apidocCodeKeywordSpan">getDocument</span>()).to.be(documentMock);
        expect(rewiredModuleB.getDocument() === documentMock).to.be(false);
        expect(document === documentMock).to.be(false);
    }
});

it("should be possible to mock global objects that are added on runtime", function () {
    var rewiredModule;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleA.getFilename" id="apidoc.element.rewire.moduleA.getFilename">
        function <span class="apidocSignatureSpan">rewire.moduleA.</span>getFilename
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getFilename() {
    return __filename;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
function checkForTypeError(err) {
expect(err.constructor).to.be(TypeError);
}

describe("rewire " + (typeof testEnv === "undefined"? "(node)": "(" + testEnv + ")&amp;#
x22;), function () {

it("should work like require()", function () {
    rewire("./moduleA.js").<span class="apidocCodeKeywordSpan">getFilename</span>();
    require("./moduleA.js").getFilename();
    expect(rewire("./moduleA.js").getFilename()).to.eql(require("./moduleA.js").getFilename());
    expect(rewire("../testLib/someOtherModule.js").filename).to.eql(require("../testLib/someOtherModule.js").
filename);
});

it("should return a fresh instance of the module", function () {
    var someOtherModule = require("./someOtherModule.js"),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleA.getMyNumber" id="apidoc.element.rewire.moduleA.getMyNumber">
        function <span class="apidocSignatureSpan">rewire.moduleA.</span>getMyNumber
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getMyNumber() {
    return myNumber;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// This is just an integration test for the __set__ method
// You can find a full test for __set__ under /test/__set__.test.js
it("should provide a working __set__ method", function () {
    var rewiredModuleA = rewire("./moduleA.js"),
        newObj = {};

    expect(rewiredModuleA.<span class="apidocCodeKeywordSpan">getMyNumber</span>()).to.be(0);
    rewiredModuleA.__set__("myNumber", 2);
    expect(rewiredModuleA.getMyNumber()).to.be(2);
    rewiredModuleA.__set__("myObj", newObj);
    expect(rewiredModuleA.getMyObj()).to.be(newObj);
    rewiredModuleA.__set__("env", "ENVENV");
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleA.getMyObj" id="apidoc.element.rewire.moduleA.getMyObj">
        function <span class="apidocSignatureSpan">rewire.moduleA.</span>getMyObj
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getMyObj() {
    return myObj;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var rewiredModuleA = rewire("./moduleA.js"),
        newObj = {};

    expect(rewiredModuleA.getMyNumber()).to.be(0);
    rewiredModuleA.__set__("myNumber", 2);
    expect(rewiredModuleA.getMyNumber()).to.be(2);
    rewiredModuleA.__set__("myObj", newObj);
    expect(rewiredModuleA.<span class="apidocCodeKeywordSpan">getMyObj</span>()).to.be(newObj);
    rewiredModuleA.__set__("env", "ENVENV");
});

// This is just an integration test for the __get__ method
// You can find a full test for __get__ under /test/__get__.test.js
it("should provide a working __get__ method", function () {
    var rewiredModuleA = rewire("./moduleA.js");
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleA.readFileSync" id="apidoc.element.rewire.moduleA.readFileSync">
        function <span class="apidocSignatureSpan">rewire.moduleA.</span>readFileSync
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function readFileSync() {
    fs.readFileSync("bla.txt", "utf8");
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
function restoreExtensions() {
    if ("coffee" in originalExtensions) {
        require.extensions[".coffee"] = originalExtensions.coffee;
    }
}

function coffeeExtension(module, filename) {
    var content = stripBOM(fs.<span class="apidocCodeKeywordSpan">readFileSync</span>(filename, "utf8"));

    content = coffee.compile(content, {
        filename: filename,
        bare: true
    });
    module._compile(content, filename);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleA.setMyNumber" id="apidoc.element.rewire.moduleA.setMyNumber">
        function <span class="apidocSignatureSpan">rewire.moduleA.</span>setMyNumber
        <span class="apidocSignatureSpan">(newNumber)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function setMyNumber(newNumber) {
    myNumber = newNumber;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleA.setMyObj" id="apidoc.element.rewire.moduleA.setMyObj">
        function <span class="apidocSignatureSpan">rewire.moduleA.</span>setMyObj
        <span class="apidocSignatureSpan">(newObj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function setMyObj(newObj) {
    myObj = newObj;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.rewire.moduleB" id="apidoc.module.rewire.moduleB">module rewire.moduleB</a></h1>


    <h2>
        <a href="#apidoc.element.rewire.moduleB.checkSomeGlobals" id="apidoc.element.rewire.moduleB.checkSomeGlobals">
        function <span class="apidocSignatureSpan">rewire.moduleB.</span>checkSomeGlobals
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function checkSomeGlobals() {
    var isLowerIE,
        typeOfGlobalFunc;

    if (typeof navigator !== "undefined") {
        isLowerIE = /MSIE [6-8]\.[0-9]/g.test(navigator.userAgent);
    }
    if (isLowerIE) {
        typeOfGlobalFunc = "object";
    } else {
        typeOfGlobalFunc = "function";
    }

    if (typeof global !== "object") {
        throw new ReferenceError("global is not an object");
    }
    if (typeof console !== "object") {
        throw new ReferenceError("console is not an object");
    }
    if (typeof require !== "function") {
        throw new ReferenceError("require is not a function");
    }
    if (typeof module !== "object") {
        throw new ReferenceError("module is not an object");
    }
    if (typeof exports !== "object") {
        throw new ReferenceError("exports is not an object");
    }
    if (module.exports === exports) {
        throw new Error("module.exports === exports returns true");
    }
    if (typeof __dirname !== "string") {
        throw new ReferenceError("__dirname is not a string");
    }
    if (typeof __filename !== "string") {
        throw new ReferenceError("__filename is not a string");
    }
    if (typeof setTimeout !== typeOfGlobalFunc) {
        throw new ReferenceError("setTimeout is not a function");
    }
    if (typeof clearTimeout !== typeOfGlobalFunc) {
        throw new ReferenceError("clearTimeout is not a function");
    }
    if (typeof setInterval !== typeOfGlobalFunc) {
        throw new ReferenceError("setInterval is not a function");
    }
    if (typeof clearInterval !== typeOfGlobalFunc) {
        throw new ReferenceError("clearInterval is not a function");
    }
    if (typeof Error !== "function") {
        throw new ReferenceError("Error is not a function");
    }
    if (typeof parseFloat !== "function") {
        throw new ReferenceError("parseFloat is not a function");
    }
    if (typeof parseInt !== "function") {
        throw new ReferenceError("parseInt is not a function");
    }
    if (typeof window === "undefined") {
        if (typeof process !== "object") {
            throw new ReferenceError("process is not an object");
        }
        if (typeof Buffer !== "function") {
            throw new ReferenceError("Buffer is not a function");
        }
    } else {
        if (typeof encodeURIComponent !== "function") {
            throw new ReferenceError("encodeURIComponent is not a function");
        }
        if (typeof decodeURIComponent !== "function") {
            throw new ReferenceError("decodeURIComponent is not a function");
        }
        if (typeof document !== "object") {
            throw new ReferenceError("document is not an object");
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    expect(require("./someOtherModule.js").__set__).to.be(undefined);
    expect(require("./someOtherModule.js").__get__).to.be(undefined);
    expect(require("./someOtherModule.js").__with__).to.be(undefined);
});

it("should not override/influence global objects by default", function () {
    // This should throw no exception
    rewire("./moduleA.js").<span class="apidocCodeKeywordSpan">checkSomeGlobals</span>();
    rewire("./moduleB.js").checkSomeGlobals();
});

// This is just an integration test for the __set__ method
// You can find a full test for __set__ under /test/__set__.test.js
it("should provide a working __set__ method", function () {
    var rewiredModuleA = rewire("./moduleA.js"),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleB.getBuffer" id="apidoc.element.rewire.moduleB.getBuffer">
        function <span class="apidocSignatureSpan">rewire.moduleB.</span>getBuffer
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getBuffer() {
    return Buffer;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
expect(rewiredModuleB.getConsole()).not.to.be(consoleMock);
expect(console).not.to.be(consoleMock);
expect(rewiredModuleA.getFilename()).to.be(newFilename);
expect(rewiredModuleB.getFilename()).not.to.be(newFilename);
expect(console).not.to.be(newFilename);
if (typeof window === "undefined") {
    rewiredModuleA.__set__("Buffer", bufferMock);
    expect(rewiredModuleA.<span class="apidocCodeKeywordSpan">getBuffer</span>()).to.be(bufferMock);
    expect(rewiredModuleB.getBuffer()).not.to.be(bufferMock);
    expect(Buffer).not.to.be(bufferMock);
} else {
    rewiredModuleA.__set__("document", documentMock);
    expect(rewiredModuleA.getDocument()).to.be(documentMock);
    expect(rewiredModuleB.getDocument() === documentMock).to.be(false);
    expect(document === documentMock).to.be(false);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleB.getConsole" id="apidoc.element.rewire.moduleB.getConsole">
        function <span class="apidocSignatureSpan">rewire.moduleB.</span>getConsole
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getConsole() {
    return console;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    documentMock = {},
    newFilename = "myFile.js";

rewiredModuleA.__set__({
    console: consoleMock,
    __filename: newFilename
});
expect(rewiredModuleA.<span class="apidocCodeKeywordSpan">getConsole</span>()).to.be(consoleMock);
expect(rewiredModuleB.getConsole()).not.to.be(consoleMock);
expect(console).not.to.be(consoleMock);
expect(rewiredModuleA.getFilename()).to.be(newFilename);
expect(rewiredModuleB.getFilename()).not.to.be(newFilename);
expect(console).not.to.be(newFilename);
if (typeof window === "undefined") {
    rewiredModuleA.__set__("Buffer", bufferMock);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleB.getDocument" id="apidoc.element.rewire.moduleB.getDocument">
        function <span class="apidocSignatureSpan">rewire.moduleB.</span>getDocument
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getDocument() {
    return document;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (typeof window === "undefined") {
        rewiredModuleA.__set__("Buffer", bufferMock);
        expect(rewiredModuleA.getBuffer()).to.be(bufferMock);
        expect(rewiredModuleB.getBuffer()).not.to.be(bufferMock);
        expect(Buffer).not.to.be(bufferMock);
    } else {
        rewiredModuleA.__set__("document", documentMock);
        expect(rewiredModuleA.<span class="apidocCodeKeywordSpan">getDocument</span>()).to.be(documentMock);
        expect(rewiredModuleB.getDocument() === documentMock).to.be(false);
        expect(document === documentMock).to.be(false);
    }
});

it("should be possible to mock global objects that are added on runtime", function () {
    var rewiredModule;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleB.getFilename" id="apidoc.element.rewire.moduleB.getFilename">
        function <span class="apidocSignatureSpan">rewire.moduleB.</span>getFilename
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getFilename() {
    return __filename;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
function checkForTypeError(err) {
expect(err.constructor).to.be(TypeError);
}

describe("rewire " + (typeof testEnv === "undefined"? "(node)": "(" + testEnv + ")&amp;#
x22;), function () {

it("should work like require()", function () {
    rewire("./moduleA.js").<span class="apidocCodeKeywordSpan">getFilename</span>();
    require("./moduleA.js").getFilename();
    expect(rewire("./moduleA.js").getFilename()).to.eql(require("./moduleA.js").getFilename());
    expect(rewire("../testLib/someOtherModule.js").filename).to.eql(require("../testLib/someOtherModule.js").
filename);
});

it("should return a fresh instance of the module", function () {
    var someOtherModule = require("./someOtherModule.js"),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleB.getMyNumber" id="apidoc.element.rewire.moduleB.getMyNumber">
        function <span class="apidocSignatureSpan">rewire.moduleB.</span>getMyNumber
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getMyNumber() {
    return myNumber;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// This is just an integration test for the __set__ method
// You can find a full test for __set__ under /test/__set__.test.js
it("should provide a working __set__ method", function () {
    var rewiredModuleA = rewire("./moduleA.js"),
        newObj = {};

    expect(rewiredModuleA.<span class="apidocCodeKeywordSpan">getMyNumber</span>()).to.be(0);
    rewiredModuleA.__set__("myNumber", 2);
    expect(rewiredModuleA.getMyNumber()).to.be(2);
    rewiredModuleA.__set__("myObj", newObj);
    expect(rewiredModuleA.getMyObj()).to.be(newObj);
    rewiredModuleA.__set__("env", "ENVENV");
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleB.getMyObj" id="apidoc.element.rewire.moduleB.getMyObj">
        function <span class="apidocSignatureSpan">rewire.moduleB.</span>getMyObj
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getMyObj() {
    return myObj;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var rewiredModuleA = rewire("./moduleA.js"),
        newObj = {};

    expect(rewiredModuleA.getMyNumber()).to.be(0);
    rewiredModuleA.__set__("myNumber", 2);
    expect(rewiredModuleA.getMyNumber()).to.be(2);
    rewiredModuleA.__set__("myObj", newObj);
    expect(rewiredModuleA.<span class="apidocCodeKeywordSpan">getMyObj</span>()).to.be(newObj);
    rewiredModuleA.__set__("env", "ENVENV");
});

// This is just an integration test for the __get__ method
// You can find a full test for __get__ under /test/__get__.test.js
it("should provide a working __get__ method", function () {
    var rewiredModuleA = rewire("./moduleA.js");
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleB.readFileSync" id="apidoc.element.rewire.moduleB.readFileSync">
        function <span class="apidocSignatureSpan">rewire.moduleB.</span>readFileSync
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function readFileSync() {
    fs.readFileSync("bla.txt", "utf8");
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
function restoreExtensions() {
    if ("coffee" in originalExtensions) {
        require.extensions[".coffee"] = originalExtensions.coffee;
    }
}

function coffeeExtension(module, filename) {
    var content = stripBOM(fs.<span class="apidocCodeKeywordSpan">readFileSync</span>(filename, "utf8"));

    content = coffee.compile(content, {
        filename: filename,
        bare: true
    });
    module._compile(content, filename);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleB.setMyNumber" id="apidoc.element.rewire.moduleB.setMyNumber">
        function <span class="apidocSignatureSpan">rewire.moduleB.</span>setMyNumber
        <span class="apidocSignatureSpan">(newNumber)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function setMyNumber(newNumber) {
    myNumber = newNumber;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleB.setMyObj" id="apidoc.element.rewire.moduleB.setMyObj">
        function <span class="apidocSignatureSpan">rewire.moduleB.</span>setMyObj
        <span class="apidocSignatureSpan">(newObj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function setMyObj(newObj) {
    myObj = newObj;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.rewire.moduleEnv" id="apidoc.module.rewire.moduleEnv">module rewire.moduleEnv</a></h1>


    <h2>
        <a href="#apidoc.element.rewire.moduleEnv.inject" id="apidoc.element.rewire.moduleEnv.inject">
        function <span class="apidocSignatureSpan">rewire.moduleEnv.</span>inject
        <span class="apidocSignatureSpan">(prelude, appendix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function inject(prelude, appendix) {
    Module.wrapper[0] = moduleWrapper0 + prelude;
    Module.wrapper[1] = appendix + moduleWrapper1;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    // Check if the module uses the strict mode.
    // If so we must ensure that "use strict"; stays at the beginning of the module.
    src = fs.readFileSync(targetPath, "utf8");
    if (detectStrictMode(src) === true) {
        prelude = ' "use strict"; ' + prelude;
    }

    moduleEnv.<span class="apidocCodeKeywordSpan">inject</span>(prelude, appendix);
    moduleEnv.load(targetModule);

    return targetModule.exports;
}

module.exports = internalRewire;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rewire.moduleEnv.load" id="apidoc.element.rewire.moduleEnv.load">
        function <span class="apidocSignatureSpan">rewire.moduleEnv.</span>load
        <span class="apidocSignatureSpan">(targetModule)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function load(targetModule) {
    nodeRequire = targetModule.require;
    targetModule.require = requireProxy;
    currentModule = targetModule;

    registerExtensions();
    targetModule.load(targetModule.id);

    // This is only necessary if nothing has been required within the module
    reset();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function load(targetModule) {
nodeRequire = targetModule.require;
targetModule.require = requireProxy;
currentModule = targetModule;

registerExtensions();
targetModule.<span class="apidocCodeKeywordSpan">load</span>(targetModule.id);

// This is only necessary if nothing has been required within the module
reset();
}

function reset() {
Module.wrapper[0] = moduleWrapper0;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.rewire.strictModule" id="apidoc.module.rewire.strictModule">module rewire.strictModule</a></h1>


    <h2>
        <a href="#apidoc.element.rewire.strictModule.doSomethingUnstrict" id="apidoc.element.rewire.strictModule.doSomethingUnstrict">
        function <span class="apidocSignatureSpan">rewire.strictModule.</span>doSomethingUnstrict
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function doSomethingUnstrict() {
    var caller = arguments.callee.caller;   // this should throw an error as a proof that strict mode is on
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
expect(rewire("./moduleA.js")).not.to.be(rewire("./moduleA.js"));
    });

    it("should preserve the strict mode", function () {
var strictModule = rewire("./strictModule.js");

expect(function () {
    strictModule.<span class="apidocCodeKeywordSpan">doSomethingUnstrict</span>();
}).to.throwException(checkForTypeError);
    });

    it("should not modify line numbers in stack traces", function () {
var throwError = rewire("./throwError.js");

if (process.env.running_under_istanbul === "1") {
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>